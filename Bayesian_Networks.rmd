> **Problem 1 : Consider the "ksl" data in the "deal" package. Eliminate
> survey year.**

+-----------------------------------------------------------------------+
| > **library**(deal)                                                   |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **library**(bnlearn)                                                |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Attaching package: \'bnlearn\'
>
> \## The following objects are masked from \'package:deal\':
>
> \##
>
> \## modelstring, nodes, nodes\<-, score

+-----------------------------------------------------------------------+
| > **data**(\"ksl\")                                                   |
+=======================================================================+
+-----------------------------------------------------------------------+

+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| > **h |       |       |       |       |       |       |       |       |
| ead** |       |       |       |       |       |       |       |       |
| (ksl) |       |       |       |       |       |       |       |       |
+=======+=======+=======+=======+=======+=======+=======+=======+=======+
| \##   | FEV   |       | > l   |       |       |       |       |       |
|       | Kol   |       | ogBMI |       |       |       |       |       |
|       | Hyp   |       | >     |       |       |       |       |       |
|       |       |       |  Smok |       |       |       |       |       |
|       |       |       | > Alc |       |       |       |       |       |
|       |       |       | >     |       |       |       |       |       |
|       |       |       |  Work |       |       |       |       |       |
|       |       |       | > Sex |       |       |       |       |       |
|       |       |       | >     |       |       |       |       |       |
|       |       |       |  Year |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| > \## |       | 1     |       | 1     | 2     | 2     | 2     | > 2   |
| > 1   |       | 3.3   |       |       |       |       |       |       |
| > 116 |       | 60375 |       |       |       |       |       |       |
| > 745 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| > \## |       | 1     |       | 2     | 2     | 2     | 1     | > 2   |
| > 2   |       | 3.4   |       |       |       |       |       |       |
| > 252 |       | 77232 |       |       |       |       |       |       |
| > 680 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| > \## |       | 1     |       | 2     | 1     | 2     | 2     | > 2   |
| > 3   |       | 3.2   |       |       |       |       |       |       |
| > 205 |       | 85038 |       |       |       |       |       |       |
| > 669 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| > \## |       | 1     |       | 2     | 1     | 2     | 2     | > 2   |
| > 4   |       | 3.1   |       |       |       |       |       |       |
| > 66  |       | 17950 |       |       |       |       |       |       |
| > 636 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| > \## |       | 1     |       | 2     | 1     | 2     | 1     | > 2   |
| > 5   |       | 3.2   |       |       |       |       |       |       |
| > 255 |       | 13260 |       |       |       |       |       |       |
| > 669 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| > \## |       | 0     |       | 2     | 1     | 2     | 2     | > 2   |
| > 6   |       | 3.4   |       |       |       |       |       |       |
| > 135 |       | 74138 |       |       |       |       |       |       |
| > 555 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+

+-----------------------------------+-----------------------------------+
| > **dim**(ksl)                    |                                   |
+===================================+===================================+
| > \## \[1\] 1083                  | > 9                               |
+-----------------------------------+-----------------------------------+

> Let us remove the survey year from the dataset :

+-----------------------------------------------------------------------+
| > ksl \<- ksl\[,**-**9\]                                              |
+=======================================================================+
+-----------------------------------------------------------------------+

+--------+--------+--------+--------+--------+--------+--------+--------+
| > *    |        |        |        |        |        |        |        |
| *head* |        |        |        |        |        |        |        |
| *(ksl) |        |        |        |        |        |        |        |
+========+========+========+========+========+========+========+========+
| \##    | FEV    |        | >      |        |        |        |        |
|        | Kol    |        | logBMI |        |        |        |        |
|        | Hyp    |        | > Smok |        |        |        |        |
|        |        |        | > Alc  |        |        |        |        |
|        |        |        | > Work |        |        |        |        |
|        |        |        | > Sex  |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 1  |        | 1      |        | 1      | 2      | 2      | > 2    |
| 116    |        | 3.     |        |        |        |        |        |
| 745    |        | 360375 |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| > \##  |        | > 1    |        | 2      | 2      | 2      | > 1    |
| > 2    |        | > 3.   |        |        |        |        |        |
| > 252  |        | 477232 |        |        |        |        |        |
| > 680  |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| > \##  |        | > 1    |        | 2      | 1      | 2      | > 2    |
| > 3    |        | > 3.   |        |        |        |        |        |
| > 205  |        | 285038 |        |        |        |        |        |
| > 669  |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| > \##  |        | > 1    |        | 2      | 1      | 2      | > 2    |
| > 4 66 |        | > 3.   |        |        |        |        |        |
| > 636  |        | 117950 |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| > \##  |        | > 1    |        | 2      | 1      | 2      | > 1    |
| > 5    |        | > 3.   |        |        |        |        |        |
| > 255  |        | 213260 |        |        |        |        |        |
| > 669  |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| > \##  |        | > 0    |        | 2      | 1      | 2      | > 2    |
| > 6    |        | > 3.   |        |        |        |        |        |
| > 135  |        | 474138 |        |        |        |        |        |
| > 555  |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+

+-----------------------------------+-----------------------------------+
| > **dim**(ksl)                    |                                   |
+===================================+===================================+
| > \## \[1\] 1083                  | > 8                               |
+-----------------------------------+-----------------------------------+

> **(a)Discretize the data -- justify your choice of discretization.**
>
> Let\'s first use log transformation to convert the integer columns in
> the data into continuous values beforediscretizing it.

+-----------------------------------------------------------------------+
| > *#Forced Ejection Volume : Convert integer into continous :*        |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > ksl**\$**FEV \<- **log**(ksl**\$**FEV)                              |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > *#Cholesterol : Convert integer into continous :*                   |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > ksl**\$**Kol \<- **log**(ksl**\$**Kol)                              |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > *#Hypertension : Convert integer into factor*                       |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > ksl**\$**Hyp \<- **as.factor**(ksl**\$**Hyp)                        |
+=======================================================================+
+-----------------------------------------------------------------------+

1

+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| > **h |       |       |       |       |       |       |       |       |
| ead** |       |       |       |       |       |       |       |       |
| (ksl) |       |       |       |       |       |       |       |       |
+=======+=======+=======+=======+=======+=======+=======+=======+=======+
| > \## | FEV   | > Kol |       | > l   |       |       |       |       |
|       |       | > Hyp |       | ogBMI |       |       |       |       |
|       |       |       |       | >     |       |       |       |       |
|       |       |       |       |  Smok |       |       |       |       |
|       |       |       |       | > Alc |       |       |       |       |
|       |       |       |       | >     |       |       |       |       |
|       |       |       |       |  Work |       |       |       |       |
|       |       |       |       | > Sex |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 1 |       |       | 1     |       | 1     | 2     | 2     | > 2   |
| 4.7   |       |       | 3.3   |       |       |       |       |       |
| 53590 |       |       | 60375 |       |       |       |       |       |
| 6.6   |       |       |       |       |       |       |       |       |
| 13384 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 2 |       |       | 1     |       | 2     | 2     | 2     | > 1   |
| 5.5   |       |       | 3.4   |       |       |       |       |       |
| 29429 |       |       | 77232 |       |       |       |       |       |
| 6.5   |       |       |       |       |       |       |       |       |
| 22093 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 3 |       |       | 1     |       | 2     | 1     | 2     | > 2   |
| 5.3   |       |       | 3.2   |       |       |       |       |       |
| 23010 |       |       | 85038 |       |       |       |       |       |
| 6.5   |       |       |       |       |       |       |       |       |
| 05784 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 4 |       |       | 1     |       | 2     | 1     | 2     | > 2   |
| 4.1   |       |       | 3.1   |       |       |       |       |       |
| 89655 |       |       | 17950 |       |       |       |       |       |
| 6.4   |       |       |       |       |       |       |       |       |
| 55199 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 5 |       |       | 1     |       | 2     | 1     | 2     | > 1   |
| 5.5   |       |       | 3.2   |       |       |       |       |       |
| 41264 |       |       | 13260 |       |       |       |       |       |
| 6.5   |       |       |       |       |       |       |       |       |
| 05784 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 6 |       |       | 0     |       | 2     | 1     | 2     | > 2   |
| 4.9   |       |       | 3.4   |       |       |       |       |       |
| 05275 |       |       | 74138 |       |       |       |       |       |
| 6.3   |       |       |       |       |       |       |       |       |
| 18968 |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+

Let us apply discretize function to Discretize the data , Let us use
"interval" method so that we have two

> groups of intervals so that we can later rename them into high and
> low.

+-----------------------------------------------------------------------+
| > discrete_df1 \<- **discretize**(ksl, method = \'interval\', breaks  |
| > = 2)                                                                |
+=======================================================================+
+-----------------------------------------------------------------------+

+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| > **  |       |       |       |       |       |       |       |       |
| head* |       |       |       |       |       |       |       |       |
| *(dis |       |       |       |       |       |       |       |       |
| crete |       |       |       |       |       |       |       |       |
| _df1) |       |       |       |       |       |       |       |       |
+=======+=======+=======+=======+=======+=======+=======+=======+=======+
| > \## | FEV   | Kol   |       | > l   |       |       |       |       |
|       |       | Hyp   |       | ogBMI |       |       |       |       |
|       |       |       |       | >     |       |       |       |       |
|       |       |       |       |  Smok |       |       |       |       |
|       |       |       |       | > Alc |       |       |       |       |
|       |       |       |       | >     |       |       |       |       |
|       |       |       |       |  Work |       |       |       |       |
|       |       |       |       | > Sex |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 1 |       |       | 1     |       | 1     | 2     | 2     | > 2   |
| \[3.  |       |       | (3.   |       |       |       |       |       |
| 63759 |       |       | 30433 |       |       |       |       |       |
| ,4.78 |       |       | ,3.84 |       |       |       |       |       |
| 624\] |       |       | 738\] |       |       |       |       |       |
| (6.   |       |       |       |       |       |       |       |       |
| 43318 |       |       |       |       |       |       |       |       |
| ,7.20 |       |       |       |       |       |       |       |       |
| 341\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 2 |       |       | 1     |       | 2     | 2     | 2     | > 1   |
| (4.   |       |       | (3.   |       |       |       |       |       |
| 78624 |       |       | 30433 |       |       |       |       |       |
| ,5.93 |       |       | ,3.84 |       |       |       |       |       |
| 489\] |       |       | 738\] |       |       |       |       |       |
| (6.   |       |       |       |       |       |       |       |       |
| 43318 |       |       |       |       |       |       |       |       |
| ,7.20 |       |       |       |       |       |       |       |       |
| 341\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 3 |       |       | 1     |       | 2     | 1     | 2     | > 2   |
| (4.   |       |       | \[2.  |       |       |       |       |       |
| 78624 |       |       | 76127 |       |       |       |       |       |
| ,5.93 |       |       | ,3.30 |       |       |       |       |       |
| 489\] |       |       | 433\] |       |       |       |       |       |
| (6.   |       |       |       |       |       |       |       |       |
| 43318 |       |       |       |       |       |       |       |       |
| ,7.20 |       |       |       |       |       |       |       |       |
| 341\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 4 |       |       | 1     |       | 2     | 1     | 2     | > 2   |
| \[3.  |       |       | \[2.  |       |       |       |       |       |
| 63759 |       |       | 76127 |       |       |       |       |       |
| ,4.78 |       |       | ,3.30 |       |       |       |       |       |
| 624\] |       |       | 433\] |       |       |       |       |       |
| (6.   |       |       |       |       |       |       |       |       |
| 43318 |       |       |       |       |       |       |       |       |
| ,7.20 |       |       |       |       |       |       |       |       |
| 341\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 5 |       |       | 1     |       | 2     | 1     | 2     | > 1   |
| (4.   |       |       | \[2.  |       |       |       |       |       |
| 78624 |       |       | 76127 |       |       |       |       |       |
| ,5.93 |       |       | ,3.30 |       |       |       |       |       |
| 489\] |       |       | 433\] |       |       |       |       |       |
| (6.   |       |       |       |       |       |       |       |       |
| 43318 |       |       |       |       |       |       |       |       |
| ,7.20 |       |       |       |       |       |       |       |       |
| 341\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 6 |       |       | 0     |       | 2     | 1     | 2     | > 2   |
| (4.   |       |       | (3.   |       |       |       |       |       |
| 78624 |       |       | 30433 |       |       |       |       |       |
| ,5.93 |       |       | ,3.84 |       |       |       |       |       |
| 489\] |       |       | 738\] |       |       |       |       |       |
| \[5.  |       |       |       |       |       |       |       |       |
| 66296 |       |       |       |       |       |       |       |       |
| ,6.43 |       |       |       |       |       |       |       |       |
| 318\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+

+-----------------------------------------------------------------------+
| > **levels**(discrete_df1**\$**FEV) \<- **c**(\"low\",\"high\")       |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **levels**(discrete_df1**\$**Kol) \<- **c**(\"low\",\"high\")       |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **levels**(discrete_df1**\$**logBMI) \<- **c**(\"low\",\"high\")    |
+=======================================================================+
+-----------------------------------------------------------------------+

> Transformed Data :

+--------+--------+--------+--------+--------+--------+--------+--------+
| > **he |        |        |        |        |        |        |        |
| ad**(d |        |        |        |        |        |        |        |
| iscret |        |        |        |        |        |        |        |
| e_df1) |        |        |        |        |        |        |        |
+========+========+========+========+========+========+========+========+
| > \##  | >      |        |        |        |        |        |        |
|        |  FEVKo |        |        |        |        |        |        |
|        | lHyplo |        |        |        |        |        |        |
|        | gBMISm |        |        |        |        |        |        |
|        | okAlcW |        |        |        |        |        |        |
|        | orkSex |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 1  |        | 1      | > high | 1      | 2      | 2      | > 2    |
| l      |        |        |        |        |        |        |        |
| owhigh |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 2  |        | 1      | > high | 2      | 2      | 2      | > 1    |
| hi     |        |        |        |        |        |        |        |
| ghhigh |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 3  |        | 1      | low    | 2      | 1      | 2      | > 2    |
| hi     |        |        |        |        |        |        |        |
| ghhigh |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 4  |        | 1      | low    | 2      | 1      | 2      | > 2    |
| l      |        |        |        |        |        |        |        |
| owhigh |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 5  |        | 1      | low    | 2      | 1      | 2      | > 1    |
| hi     |        |        |        |        |        |        |        |
| ghhigh |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 6  |        | 0      | > high | 2      | 1      | 2      | > 2    |
| h      |        |        |        |        |        |        |        |
| ighlow |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+

> **(b)Ensure all the variables are "factors". Fit a multinomial
> Bayesian Network. Describe your approach.**
>
> **Report the structure and the parameterization.**
>
> Let us fit a Bayesian Network to the data :
>
> *Structure Learning:*

+-----------------------------------------------------------------------+
| > BN1 \<- **hc**(discrete_df1, score = \"bic\")                       |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > BN1                                                                 |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Bayesian network learned via Score-based methods
>
> \##
>
> \## model:
>
> \##
> \[Smok\]\[Sex\|Smok\]\[FEV\|Sex\]\[Kol\|Sex\]\[Alc\|Sex\]\[Work\|Sex\]\[Hyp\|Kol\]\[logBMI\|Hyp\]
>
> \## nodes: 8
>
> \## arcs: 7
>
> \## undirected arcs: 0

2

![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image1.png){width="4.680555555555555in"
height="2.6805555555555554in"}

+-----------------------+-----------------------+-----------------------+
| > \##                 | > directed arcs:      | > 7                   |
+=======================+=======================+=======================+
| > \##                 | > average markov      | > 1.75                |
|                       | > blanket size:       |                       |
+-----------------------+-----------------------+-----------------------+
| > \##                 | > average             | > 1.75                |
|                       | > neighbourhood size: |                       |
+-----------------------+-----------------------+-----------------------+
| > \##                 | > average branching   | > 0.88                |
|                       | > factor:             |                       |
+-----------------------+-----------------------+-----------------------+

> \##

+-----------------------+-----------------------+-----------------------+
| \##                   | > learning algorithm: | > Hill-Climbing       |
+=======================+=======================+=======================+
| \##                   | > score:              | > BIC (disc.)         |
+-----------------------+-----------------------+-----------------------+
| \##                   | > penalization        | > 3.493745            |
|                       | > coefficient:        |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | tests used in the     | > 77                  |
|                       | learning procedure:   |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > optimized:          | > TRUE                |
+-----------------------+-----------------------+-----------------------+

The following is the best structure found using the BIC score-based
indexing and the hill climbing method:

+-----------------------------------------------------------------------+
| > **plot**(BN1)                                                       |
+=======================================================================+
+-----------------------------------------------------------------------+

Sex

+-----------------+-----------------+-----------------+-----------------+
| Kol             | > FEV           | Work            | > Alc           |
+=================+=================+=================+=================+
|                 | > Hyp           | Smok            |                 |
+-----------------+-----------------+-----------------+-----------------+

logBMI

> *Parametre Leaning :*

Let\'s use the maximum likelihood estimation approach to parametrize the
trained network:

+-----------------------------------------------------------------------+
| > bn_fit1 \<- **bn.fit**(BN1,data = discrete_df1,method = \"mle\")    |
+=======================================================================+
+-----------------------------------------------------------------------+

> Parameters of the model fitted :

+-----------------------------------------------------------------------+
| > bn_fit1                                                             |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Bayesian network parameters
>
> \##
>
> \## Parameters of node FEV (multinomial distribution)
>
> \##
>
> \## Conditional probability table:
>
> \##
>
> \## Sex
>
> \## FEV 1 2
>
> \## low 0.1113074 0.2340426
>
> \## high 0.8886926 0.7659574
>
> \##
>
> \## Parameters of node Kol (multinomial distribution)
>
> \##
>
> \## Conditional probability table:
>
> \##

3

> \## Sex
>
> ##Kol 1 2
>
> \## low 0.4328622 0.2050290
>
> \## high 0.5671378 0.7949710
>
> \##
>
> \## Parameters of node Hyp (multinomial distribution)
>
> \##
>
> ##Conditional probability table:
>
> \##
>
> \## Kol
>
> ##Hyp low high

\## 0 0.5128205 0.4193989

\## 1 0.4871795 0.5806011

\##

\## Parameters of node logBMI (multinomial distribution)

\##

\## Conditional probability table:

\##

\## Hyp

\## logBMI 0 1

\## low 0.8172485 0.6174497

\## high 0.1827515 0.3825503

\##

\## Parameters of node Smok (multinomial distribution)

\##

\## Conditional probability table:

+-----------------------+-----------------------+-----------------------+
| \##                   | 1                     | > 2                   |
+=======================+=======================+=======================+
+-----------------------+-----------------------+-----------------------+

\## 0.2825485 0.7174515

\##

\## Parameters of node Alc (multinomial distribution)

\##

\## Conditional probability table:

\##

\## Sex

\## Alc 1 2

\## 1 0.3533569 0.6460348

\## 2 0.6466431 0.3539652

\##

\## Parameters of node Work (multinomial distribution)

\##

\## Conditional probability table:

\##

\## Sex

\## Work 1 2

\## 1 0.21554770 0.07736944

\## 2 0.78445230 0.92263056

\##

\## Parameters of node Sex (multinomial distribution)

\##

\## Conditional probability table:

\##

\## Smok

\## Sex 1 2

\## 1 0.2222222 0.6409266

4

![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image2.png){width="4.680555555555555in"
height="2.6666666666666665in"}

> \## 2 0.7777778 0.3590734
>
> The above reports the conditional probability tables for all the nodes
> in the network.
>
> **(c)Find the CPDAG for your network in B.**
>
> To find the CPDAG of the network :

+-----------------------------------------------------------------------+
| > CP_DAG1 \<- **cpdag**(bn_fit1)                                      |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > CP_DAG1                                                             |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Random/Generated Bayesian network
>
> \##

+-----------------------+-----------------------+-----------------------+
| \##                   | > model:              | > 8                   |
+=======================+=======================+=======================+
| \##                   | > \[undirected        |                       |
|                       | > graph\]             |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > nodes:              |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > arcs:               | > 7                   |
+-----------------------+-----------------------+-----------------------+
| \##                   | > undirected arcs:    | > 7                   |
+-----------------------+-----------------------+-----------------------+
| \##                   | > directed arcs:      | > 0                   |
+-----------------------+-----------------------+-----------------------+
| \##                   | > average markov      | > 1.75                |
|                       | > blanket size:       |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > average             | > 1.75                |
|                       | > neighbourhood size: |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > average branching   | > 0.00                |
|                       | > factor:             |                       |
+-----------------------+-----------------------+-----------------------+

> \##

+-----------------------+-----------------------+-----------------------+
| \##                   | > generation          | > Empty               |
|                       | > algorithm:          |                       |
+=======================+=======================+=======================+
+-----------------------+-----------------------+-----------------------+

+-----------------------------------------------------------------------+
| > **plot**(CP_DAG1)                                                   |
+=======================================================================+
+-----------------------------------------------------------------------+

Sex

+-----------------+-----------------+-----------------+-----------------+
| Kol             | > FEV           | Work            | > Alc           |
+=================+=================+=================+=================+
|                 | > Hyp           | Smok            |                 |
+-----------------+-----------------+-----------------+-----------------+

logBMI

\### (d) Find an alternative

> DAG generated from the CPDAG that is a member of the equivalence same
> equivalence class as your DAG
>
> in b.

Alternative_DAG \<-
**model2network**(\"\[Smok\]\[Sex\|Smok\]\[FEV\|Sex\]\[Kol\|Sex\]\[Alc\|Sex\]\[Work\|Sex\]\[Hyp\|Kol\]\[logBMI

> **plot**(Alternative_DAG)

5

![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image3.png){width="4.680555555555555in"
height="2.6805555555555554in"}![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image4.png){width="4.680555555555555in"
height="2.6805555555555554in"}

Work

+-----------------+-----------------+-----------------+-----------------+
| FEV             | > Alc           | Smok            | > Sex           |
+=================+=================+=================+=================+
|                 | > Hyp           | logBMI          |                 |
+-----------------+-----------------+-----------------+-----------------+

Kol

+-----------------------------------------------------------------------+
| > alt \<- **cextend**(BN1)                                            |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **plot**(alt)                                                       |
+=======================================================================+
+-----------------------------------------------------------------------+

Sex

+-----------------+-----------------+-----------------+-----------------+
| Kol             | > FEV           | Work            | > Alc           |
+=================+=================+=================+=================+
|                 | > Hyp           | Smok            |                 |
+-----------------+-----------------+-----------------+-----------------+

logBMI

> \(e\) **According to your BN, are individuals that consume alcohol and
> smoke more likely to have higher forced ejection volumes? Justify your
> answer.**
>
> In this case ,
>
> The event is *FEV = High* The evidence is *Alcohol = 2 (Frequent) and
> smoke = 2 (Yes)*

+-----------------------------------------------------------------------+
| > **cpquery**(bn_fit1 , event = (FEV **==** \"high\") , evidence =    |
| > (Alc **==** 2) **&** (Smok **==** 2))                               |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## \[1\] 0.8502004\
> According to the information above, there is an 84.3 percent
> likelihood that someone who regularly uses tobacco and alcohol will
> have a larger forced ejection volume.

so that the response can be supported Yes.

> **(f)According to your BN, are individuals that consume alcohol and
> have hypertension more likely to have low forced ejection volumes?
> Justify your answer**
>
> In this case ,
>
> The event is *FEV = low* The evidence is *Alcohol = 2 (Frequent) and
> hypertension = 1 (Yes)*

6

+-----------------------------------------------------------------------+
| > **cpquery**(bn_fit1 , event = (FEV **==** \"low\") , evidence =     |
| > (Alc **==** 2) **&** (Hyp **==** 1))                                |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## \[1\] 0.1638341

The reply is no. According to the information above, there is only a
14.6% likelihood that someone who drinks and has

hypertension will have poor forced ejection volumes.

> **(g)Discretize the data using an alternative technique (vs what was
> done in part A). Learn the BN using your**
>
> **approach in part B. How does it differ from the BN learned in Part
> B? Is the CPDAG different?**
>
> Instead of using interval method, we will use the hartemink method

+-----------------------------------------------------------------------+
| > discrete_df2 \<- **discretize**(ksl, method = \'hartemink\', breaks |
| > = 2)                                                                |
+=======================================================================+
+-----------------------------------------------------------------------+

+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| > **  |       |       |       |       |       |       |       |       |
| head* |       |       |       |       |       |       |       |       |
| *(dis |       |       |       |       |       |       |       |       |
| crete |       |       |       |       |       |       |       |       |
| _df2) |       |       |       |       |       |       |       |       |
+=======+=======+=======+=======+=======+=======+=======+=======+=======+
| > \## | FEV   | Kol   |       | >     |       |       |       |       |
|       |       | Hyp   |       | logBM |       |       |       |       |
|       |       |       |       | ISmok |       |       |       |       |
|       |       |       |       | AlcWo |       |       |       |       |
|       |       |       |       | rkSex |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 1 |       |       | > 1   |       | 1     | 2     | 2     | > 2   |
| \[3   |       |       | >     |       |       |       |       |       |
| .6375 |       |       |  \[2. |       |       |       |       |       |
| 9,5.4 |       |       | 76127 |       |       |       |       |       |
| 161\] |       |       | ,3.43 |       |       |       |       |       |
| \[5.  |       |       | 978\] |       |       |       |       |       |
| 66296 |       |       |       |       |       |       |       |       |
| ,6.70 |       |       |       |       |       |       |       |       |
| 401\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 2 |       |       | > 1   |       | 2     | 2     | 2     | > 1   |
| (5    |       |       | > (3. |       |       |       |       |       |
| .4161 |       |       | 43978 |       |       |       |       |       |
| ,5.93 |       |       | ,3.84 |       |       |       |       |       |
| 489\] |       |       | 738\] |       |       |       |       |       |
| \[5.  |       |       |       |       |       |       |       |       |
| 66296 |       |       |       |       |       |       |       |       |
| ,6.70 |       |       |       |       |       |       |       |       |
| 401\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 3 |       |       | > 1   |       | 2     | 1     | 2     | > 2   |
| \[3   |       |       | >     |       |       |       |       |       |
| .6375 |       |       |  \[2. |       |       |       |       |       |
| 9,5.4 |       |       | 76127 |       |       |       |       |       |
| 161\] |       |       | ,3.43 |       |       |       |       |       |
| \[5.  |       |       | 978\] |       |       |       |       |       |
| 66296 |       |       |       |       |       |       |       |       |
| ,6.70 |       |       |       |       |       |       |       |       |
| 401\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 4 |       |       | > 1   |       | 2     | 1     | 2     | > 2   |
| \[3   |       |       | >     |       |       |       |       |       |
| .6375 |       |       |  \[2. |       |       |       |       |       |
| 9,5.4 |       |       | 76127 |       |       |       |       |       |
| 161\] |       |       | ,3.43 |       |       |       |       |       |
| \[5.  |       |       | 978\] |       |       |       |       |       |
| 66296 |       |       |       |       |       |       |       |       |
| ,6.70 |       |       |       |       |       |       |       |       |
| 401\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 5 |       |       | > 1   |       | 2     | 1     | 2     | > 1   |
| (5    |       |       | >     |       |       |       |       |       |
| .4161 |       |       |  \[2. |       |       |       |       |       |
| ,5.93 |       |       | 76127 |       |       |       |       |       |
| 489\] |       |       | ,3.43 |       |       |       |       |       |
| \[5.  |       |       | 978\] |       |       |       |       |       |
| 66296 |       |       |       |       |       |       |       |       |
| ,6.70 |       |       |       |       |       |       |       |       |
| 401\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| \## 6 |       |       | > 0   |       | 2     | 1     | 2     | > 2   |
| \[3   |       |       | > (3. |       |       |       |       |       |
| .6375 |       |       | 43978 |       |       |       |       |       |
| 9,5.4 |       |       | ,3.84 |       |       |       |       |       |
| 161\] |       |       | 738\] |       |       |       |       |       |
| \[5.  |       |       |       |       |       |       |       |       |
| 66296 |       |       |       |       |       |       |       |       |
| ,6.70 |       |       |       |       |       |       |       |       |
| 401\] |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+

+-----------------------------------------------------------------------+
| > **levels**(discrete_df2**\$**FEV) \<- **c**(\"low\",\"high\")       |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **levels**(discrete_df2**\$**Kol) \<- **c**(\"low\",\"high\")       |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **levels**(discrete_df2**\$**logBMI) \<- **c**(\"low\",\"high\")    |
+=======================================================================+
+-----------------------------------------------------------------------+

+--------+--------+--------+--------+--------+--------+--------+--------+
| > **he |        |        |        |        |        |        |        |
| ad**(d |        |        |        |        |        |        |        |
| iscret |        |        |        |        |        |        |        |
| e_df2) |        |        |        |        |        |        |        |
+========+========+========+========+========+========+========+========+
| \##    | > FEV  |        |        |        |        |        |        |
|        | KolHyp |        |        |        |        |        |        |
|        | logBMI |        |        |        |        |        |        |
|        | > S    |        |        |        |        |        |        |
|        | mokAlc |        |        |        |        |        |        |
|        | > Work |        |        |        |        |        |        |
|        | > Sex  |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 1  |        | 1      | low    | 1      | 2      | 2      | > 2    |
| lowlow |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 2  |        | 1      | > high | 2      | 2      | 2      | > 1    |
| h      |        |        |        |        |        |        |        |
| ighlow |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 3  |        | 1      | low    | 2      | 1      | 2      | > 2    |
| lowlow |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 4  |        | 1      | low    | 2      | 1      | 2      | > 2    |
| lowlow |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 5  |        | 1      | low    | 2      | 1      | 2      | > 1    |
| h      |        |        |        |        |        |        |        |
| ighlow |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| \## 6  |        | 0      | > high | 2      | 1      | 2      | > 2    |
| lowlow |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+

+-----------------------------------------------------------------------+
| > BN2 \<- **hc**(discrete_df2, score = \"bic\")                       |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > BN2                                                                 |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Bayesian network learned via Score-based methods
>
> \##
>
> \## model:
>
> \##
> \[Hyp\]\[logBMI\|Hyp\]\[Sex\|logBMI\]\[FEV\|Sex\]\[Kol\|Sex\]\[Smok\|Sex\]\[Alc\|Sex\]\[Work\|Sex\]
>
> \## nodes: 8
>
> \## arcs: 7
>
> \## undirected arcs: 0
>
> \## directed arcs: 7
>
> \## average markov blanket size: 1.75
>
> \## average neighbourhood size: 1.75
>
> \## average branching factor: 0.88
>
> \##

+-----------------------+-----------------------+-----------------------+
| \##                   | > learning algorithm: | > Hill-Climbing       |
+=======================+=======================+=======================+
| \##                   | > score:              | > BIC (disc.)         |
+-----------------------+-----------------------+-----------------------+
| \##                   | > penalization        | > 3.493745            |
|                       | > coefficient:        |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | tests used in the     | > 91                  |
|                       | learning procedure:   |                       |
+-----------------------+-----------------------+-----------------------+

7

![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image5.png){width="4.680555555555555in"
height="2.6666666666666665in"}

+-----------------------+-----------------------+-----------------------+
| \##                   | > optimized:          | > TRUE                |
+=======================+=======================+=======================+
+-----------------------+-----------------------+-----------------------+

+-----------------------------------------------------------------------+
| > **plot**(BN2)                                                       |
+=======================================================================+
+-----------------------------------------------------------------------+

Sex

+-----------------+-----------------+-----------------+-----------------+
| Kol             | > FEV           | Work            | > Alc           |
+=================+=================+=================+=================+
|                 | > Hyp           | Smok            |                 |
+-----------------+-----------------+-----------------+-----------------+

logBMI

+-----------------------------------------------------------------------+
| > bn_fit2 \<- **bn.fit**(BN2,data = discrete_df1,method = \"mle\")    |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > bn_fit2                                                             |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Bayesian network parameters
>
> \##
>
> \## Parameters of node FEV (multinomial distribution)
>
> \##
>
> \## Conditional probability table:
>
> \##
>
> \## Sex
>
> \## FEV 1 2
>
> \## low 0.1113074 0.2340426
>
> \## high 0.8886926 0.7659574
>
> \##
>
> \## Parameters of node Kol (multinomial distribution)
>
> \##
>
> \## Conditional probability table:
>
> \##
>
> \## Sex
>
> \## Kol 1 2
>
> \## low 0.4328622 0.2050290
>
> \## high 0.5671378 0.7949710
>
> \##
>
> \## Parameters of node Hyp (multinomial distribution)
>
> \##
>
> \## Conditional probability table:

+-----------------------+-----------------------+-----------------------+
| > \##                 | 0                     | > 1                   |
+=======================+=======================+=======================+
+-----------------------+-----------------------+-----------------------+

> \## 0.4496768 0.5503232
>
> \##
>
> \## Parameters of node logBMI (multinomial distribution)
>
> \##
>
> \## Conditional probability table:
>
> \##

8

> \## Hyp
>
> \## logBMI 0 1
>
> \## low 0.8172485 0.6174497
>
> \## high 0.1827515 0.3825503
>
> \##
>
> \## Parameters of node Smok (multinomial distribution)
>
> \##
>
> \## Conditional probability table:
>
> \##
>
> \## Sex
>
> \## Smok 1 2
>
> \## 1 0.1201413 0.4603482
>
> \## 2 0.8798587 0.5396518
>
> \##
>
> \## Parameters of node Alc (multinomial distribution)
>
> \##
>
> \## Conditional probability table:
>
> \##
>
> \## Sex
>
> \## Alc 1 2
>
> \## 1 0.3533569 0.6460348
>
> \## 2 0.6466431 0.3539652
>
> \##
>
> \## Parameters of node Work (multinomial distribution)
>
> \##
>
> \## Conditional probability table:
>
> \##
>
> \## Sex
>
> \## Work 1 2
>
> \## 1 0.21554770 0.07736944
>
> \## 2 0.78445230 0.92263056
>
> \##
>
> \## Parameters of node Sex (multinomial distribution)
>
> \##
>
> \## Conditional probability table:
>
> \##
>
> \## logBMI
>
> \## Sex low high
>
> \## 1 0.5522193 0.4511041
>
> \## 2 0.4477807 0.5488959

+-----------------------------------------------------------------------+
| > CP_DAG2 \<- **cpdag**(bn_fit2)                                      |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **plot**(CP_DAG2)                                                   |
+=======================================================================+
+-----------------------------------------------------------------------+

9

![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image6.png){width="4.680555555555555in"
height="2.6805555555555554in"}

Sex

+-----------------+-----------------+-----------------+-----------------+
| Kol             | > FEV           | Work            | > Alc           |
+=================+=================+=================+=================+
|                 | > Hyp           | Smok            |                 |
+-----------------+-----------------+-----------------+-----------------+

logBMI

The model trained and the cpdag are the identical for both scenarios
even though the data were discretized using two distinct ways.

+-----------------------------------------------------------------------+
| > **compare**(BN1,BN2)                                                |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## \$tp\
> \## \[1\] 5\
> \##\
> \## \$fp\
> \## \[1\] 2\
> \##\
> \## \$fn\
> \## \[1\] 2

10

![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image7.png){width="0.625in"
height="0.625in"}![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image8.png){width="0.625in"
height="0.625in"}![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image9.png){width="0.625in"
height="0.625in"}![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image10.png){width="0.625in"
height="0.625in"}![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image11.png){width="0.625in"
height="0.625in"}![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image12.png){width="0.625in"
height="0.625in"}

> **Problem 2 : Consider the "marks" data in the "bnlearn" package**

+-----------------------------------------------------------------------+
| > **library**(bnlearn)                                                |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > df \<- bnlearn**::**marks                                           |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **dim**(df)                                                         |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## \[1\] 88 5

+-------------+-------------+-------------+-------------+-------------+
| > *         |             |             |             |             |
| *head**(df) |             |             |             |             |
+=============+=============+=============+=============+=============+
| \##         | > MECH VECT |             |             |             |
|             | > ALG ANL   |             |             |             |
|             | > STAT      |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| \## 1 77    |             |             | 82 67 67    | > 81        |
+-------------+-------------+-------------+-------------+-------------+
| \## 2       |             | 63          | 78 80 70    | > 81        |
+-------------+-------------+-------------+-------------+-------------+
| \## 3       |             | 75          | 73 71 66    | > 81        |
+-------------+-------------+-------------+-------------+-------------+
| \## 4       |             | 55          | 72 63 70    | > 68        |
+-------------+-------------+-------------+-------------+-------------+
| \## 5       |             | 63          | 63 65 70    | > 63        |
+-------------+-------------+-------------+-------------+-------------+
| \## 6       |             | 53          | 61 72 64    | > 73        |
+-------------+-------------+-------------+-------------+-------------+

> **(a)Create a bn object describing the below graph:**

We establish an empty graph with the designated nodes in order to
generate the bayesian network.

+-----------------------------------------------------------------------+
| > dag \<- **empty.graph**(nodes =                                     |
| > **c**(\"ANL\",\"MECH\",\"LAT\",\"ALG\",\"STAT\",\"VECT\"))          |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **plot**(dag)                                                       |
+=======================================================================+
+-----------------------------------------------------------------------+

VECT

> ANL STAT
>
> MECH ALG

LAT

Let us specify the edges :

+-----------------------------------------------------------------------+
| > dag \<- **set.arc**(dag, from = \"MECH\", to = \"LAT\")             |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > dag \<- **set.arc**(dag, from = \"ANL\", to = \"LAT\")              |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > dag \<- **set.arc**(dag, from = \"LAT\", to = \"ALG\")              |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > dag \<- **set.arc**(dag, from = \"LAT\", to = \"STAT\")             |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > dag \<- **set.arc**(dag, from = \"LAT\", to = \"VECT\")             |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > dag                                                                 |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Random/Generated Bayesian network
>
> \##
>
> \## model:
>
> \##
> \[ANL\]\[MECH\]\[LAT\|ANL:MECH\]\[ALG\|LAT\]\[STAT\|LAT\]\[VECT\|LAT\]
>
> \## nodes: 6
>
> \## arcs: 5
>
> \## undirected arcs: 0

11

![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image13.png){width="4.138888888888889in"
height="2.6805555555555554in"}![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image14.png){width="4.138888888888889in"
height="2.6805555555555554in"}

+-----------------------+-----------------------+-----------------------+
| \##                   | > directed arcs:      | > 5                   |
+=======================+=======================+=======================+
| \##                   | > average markov      | > 2.00                |
|                       | > blanket size:       |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > average             | > 1.67                |
|                       | > neighbourhood size: |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > average branching   | > 0.83                |
|                       | > factor:             |                       |
+-----------------------+-----------------------+-----------------------+

> \##

+-----------------------+-----------------------+-----------------------+
| \##                   | > generation          | > Empty               |
|                       | > algorithm:          |                       |
+=======================+=======================+=======================+
+-----------------------+-----------------------+-----------------------+

+-----------------------------------------------------------------------+
| > **plot**(dag)                                                       |
+=======================================================================+
+-----------------------------------------------------------------------+

> VECT\
> ANL STAT
>
> MECH ALG LAT
>
> **(b)Find the CPDAG**
>
> To generate a CPDAG , we can use the following :

+-----------------------------------------------------------------------+
| > CP_DAG \<- **cpdag**(dag)                                           |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **plot**(CP_DAG)                                                    |
+=======================================================================+
+-----------------------------------------------------------------------+

> VECT\
> ANL STAT
>
> MECH ALG LAT

+-----------------------------------------------------------------------+
| > **all.equal**(dag,CP_DAG)                                           |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## \[1\] TRUE

We can see that the original network and the completed partially
directed acyclic graph (CPDAG) are identical.

12

![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image15.png){width="4.486111111111111in"
height="2.4722222222222223in"}

> **(c)Use hc to find the most likely structure. How does it differ from
> the above DAG?**
>
> Let us apply hill climbing algorithm using score based method :

+-----------------------------------------------------------------------+
| > mls \<- **hc**(df)                                                  |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > mls                                                                 |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Bayesian network learned via Score-based methods
>
> \##
>
> \## model:
>
> \##
> \[MECH\]\[VECT\|MECH\]\[ALG\|MECH:VECT\]\[ANL\|ALG\]\[STAT\|ALG:ANL\]
>
> \## nodes: 5
>
> \## arcs: 6
>
> \## undirected arcs: 0
>
> \## directed arcs: 6
>
> \## average markov blanket size: 2.40
>
> \## average neighbourhood size: 2.40
>
> \## average branching factor: 1.20
>
> \##

+-----------------------+-----------------------+-----------------------+
| \##                   | > learning algorithm: | > Hill-Climbing       |
+=======================+=======================+=======================+
| \##                   | > score:              | > BIC (Gauss.)        |
+-----------------------+-----------------------+-----------------------+
| \##                   | > penalization        | > 2.238668            |
|                       | > coefficient:        |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | tests used in the     | > 34                  |
|                       | learning procedure:   |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > optimized:          | > TRUE                |
+-----------------------+-----------------------+-----------------------+

> Let us plot the most likely structure obtained from above :

+-----------------------------------------------------------------------+
| > **plot**(mls)                                                       |
+=======================================================================+
+-----------------------------------------------------------------------+

STAT

+-----------------+-----------------+-----------------+-----------------+
| MECH            | > VECT          | ALG             | > ANL           |
+=================+=================+=================+=================+
+-----------------+-----------------+-----------------+-----------------+

From the foregoing, we can

conclude that the structure is most likely devoid of the node that
changed the graph\'s edges..

+-----------------------------------------------------------------------+
| > **nodes**(dag)                                                      |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## \[1\] \"ANL\" \"MECH\" \"LAT\" \"ALG\" \"STAT\" \"VECT\"

+-----------------------------------------------------------------------+
| > **nodes**(mls)                                                      |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## \[1\] \"MECH\" \"VECT\" \"ALG\" \"ANL\" \"STAT\"

+-----------------------------------------------------------------------+
| > **modelstring**(dag)                                                |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## \[1\]
> \"\[ANL\]\[MECH\]\[LAT\|ANL:MECH\]\[ALG\|LAT\]\[STAT\|LAT\]\[VECT\|LAT\]\"

13

+-----------------------------------------------------------------------+
| > **modelstring**(mls)                                                |
+=======================================================================+
+-----------------------------------------------------------------------+

\## \[1\]
\"\[MECH\]\[VECT\|MECH\]\[ALG\|MECH:VECT\]\[ANL\|ALG\]\[STAT\|ALG:ANL\]\"\
It is possible to see above how the distributions differ. Additionally,
we can detect some fluctuation in the arc measurement.

14

> **Problem 3 : The "carcass" data from the package "gRbase" contains
> data on meat. Specifically, the data describes the thickness of meat
> and fat layers in different regions on the back of a pig together with
> the lean meat percentage on each of 344 carcasses. The data has been
> used for prediction of lean meat percentage based on carcass
> thickness.**

+-----------------------------------------------------------------------+
| > **library**(gRbase)                                                 |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Attaching package: \'gRbase\'
>
> \## The following objects are masked from \'package:bnlearn\':
>
> \##
>
> \## ancestors, children, nodes, parents
>
> \## The following object is masked from \'package:deal\':
>
> \##

+-----------------------------------+-----------------------------------+
| > \##                             | > nodes                           |
+===================================+===================================+
+-----------------------------------+-----------------------------------+

+-----------------------------------------------------------------------+
| > **data**(\"carcass\")                                               |
+=======================================================================+
+-----------------------------------------------------------------------+

+---------+---------+---------+---------+---------+---------+---------+
| > **h   |         |         |         |         |         |         |
| ead**(c |         |         |         |         |         |         |
| arcass) |         |         |         |         |         |         |
+=========+=========+=========+=========+=========+=========+=========+
| > \##   | > Fat11 |         |         |         |         |         |
|         | >       |         |         |         |         |         |
|         |  Meat11 |         |         |         |         |         |
|         | > Fat12 |         |         |         |         |         |
|         | >       |         |         |         |         |         |
|         |  Meat12 |         |         |         |         |         |
|         | > Fat13 |         |         |         |         |         |
|         | >       |         |         |         |         |         |
|         |  Meat13 |         |         |         |         |         |
|         | > L     |         |         |         |         |         |
|         | eanMeat |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| \## 1   | 17      | 51      | 12      | 51      | 12      | > 61    |
|         |         |         |         |         |         | > 5     |
|         |         |         |         |         |         | 6.52475 |
+---------+---------+---------+---------+---------+---------+---------+
| \## 2   | 17      | 49      | 15      | 48      | 15      | > 54    |
|         |         |         |         |         |         | > 5     |
|         |         |         |         |         |         | 7.57958 |
+---------+---------+---------+---------+---------+---------+---------+
| \## 3   | 14      | 38      | 11      | 34      | 11      | > 40    |
|         |         |         |         |         |         | > 5     |
|         |         |         |         |         |         | 5.88994 |
+---------+---------+---------+---------+---------+---------+---------+
| \## 4   | 17      | 58      | 12      | 58      | 11      | > 58    |
|         |         |         |         |         |         | > 6     |
|         |         |         |         |         |         | 1.81719 |
+---------+---------+---------+---------+---------+---------+---------+
| \## 5   | 14      | 51      | 12      | 48      | 13      | > 54    |
|         |         |         |         |         |         | > 6     |
|         |         |         |         |         |         | 2.95964 |
+---------+---------+---------+---------+---------+---------+---------+
| \## 6   | 20      | 40      | 14      | 40      | 14      | > 45    |
|         |         |         |         |         |         | > 5     |
|         |         |         |         |         |         | 4.57870 |
+---------+---------+---------+---------+---------+---------+---------+

> let us transform the data into log scale to make it continous :

+-----------------------------------------------------------------------+
| > carcass**\$**Fat11 \<- **log**(carcass**\$**Fat11)                  |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > carcass**\$**Meat11 \<- **log**(carcass**\$**Meat11)                |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > carcass**\$**Fat12 \<- **log**(carcass**\$**Fat12)                  |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > carcass**\$**Meat12 \<- **log**(carcass**\$**Meat12)                |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > carcass**\$**Fat13 \<- **log**(carcass**\$**Fat13)                  |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > carcass**\$**Meat13 \<- **log**(carcass**\$**Meat13)                |
+=======================================================================+
+-----------------------------------------------------------------------+

+---------+---------+---------+---------+---------+---------+---------+
| > **h   |         |         |         |         |         |         |
| ead**(c |         |         |         |         |         |         |
| arcass) |         |         |         |         |         |         |
+=========+=========+=========+=========+=========+=========+=========+
| > \##   | Fat11   | Meat11  | Fat12   | Meat12  | > Fat13 | >       |
|         |         |         |         |         |         |  Meat13 |
|         |         |         |         |         |         | > L     |
|         |         |         |         |         |         | eanMeat |
+---------+---------+---------+---------+---------+---------+---------+

> \## 1 2.833213 3.931826 2.484907 3.931826 2.484907 4.110874 56.52475
>
> \## 2 2.833213 3.891820 2.708050 3.871201 2.708050 3.988984 57.57958
>
> \## 3 2.639057 3.637586 2.397895 3.526361 2.397895 3.688879 55.88994
>
> \## 4 2.833213 4.060443 2.484907 4.060443 2.397895 4.060443 61.81719
>
> \## 5 2.639057 3.931826 2.484907 3.871201 2.564949 3.988984 62.95964
>
> \## 6 2.995732 3.688879 2.639057 3.688879 2.639057 3.806662 54.57870
>
> **(a)Create a BN using score-based structural learning and ensure that
> "Lean Meat" is at the bottom of the network.**
>
> Learn the structure of the network using score based method :

+-----------------------------------------------------------------------+
| > BN3 \<- **hc**(carcass, score = \"bge\")                            |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > BN3                                                                 |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##

15

> \## Bayesian network learned via Score-based methods
>
> \##
>
> \## model:
>
> \##
> \[Fat11\]\[Meat11\]\[Meat12\|Fat11:Meat11\]\[Meat13\|Fat11:Meat11:Meat12\]
>
> \##
> \[LeanMeat\|Fat11:Meat11:Meat12\]\[Fat13\|Fat11:Meat11:Meat12:Meat13:LeanMeat\]
>
> \## \[Fat12\|Fat11:Meat11:Meat12:Fat13:Meat13:LeanMeat\]
>
> \## nodes: 7
>
> \## arcs: 19
>
> \## undirected arcs: 0
>
> \## directed arcs: 19
>
> \## average markov blanket size: 6.00
>
> \## average neighbourhood size: 5.43
>
> \## average branching factor: 2.71
>
> \##
>
> \## learning algorithm: Hill-Climbing
>
> \## score: Bayesian Gaussian (BGe)
>
> \## graph prior: Uniform
>
> \## imaginary sample size(normal): 1
>
> \## imaginary sample size(Wishart): 9
>
> \## tests used in the learning procedure:159
>
> \## optimized: TRUE
>
> **(b)Create a BN using conditional independence tests for structural
> learning and ensure that**
>
> **"Lean Meat" is at the bottom of the network.**
>
> ![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image16.png){width="7.194444444444445in"
> height="1.4305555555555556in"}
>
> **(c)How do the networks in A-B compare?**

The networks found in parts (a) and (b) have various structural
compositions. The conditional independence tests for structural learning

algorithm (part b) estimates conditional independence relationships,
whereas the score-based structural learning algorithm (part a)

employs a scoring function to discover the optimal structure. As we can
see from the aforementioned pictures, the resulting networks are

completely unique, have various arc structures, and represent various
assumptions on the conditional dependencies in the data. While

figure 2 has a nested structure, figure 1 has a more linear structure.

> **(d)How does the model compare with A?**
>
> ![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image17.png){width="5.958333333333333in"
> height="1.7361111111111112in"}

16

The comparison results will provide insights into the differences
between the learned structure of the simulated dataset and the original
model in terms of edge presence, direction, and other structural
characteristics.

**(e)Simulate a dataset from your BN in part A with 100 samples, then
learn the structure,**

**how does the model compare with A**

![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image18.png){width="5.902777777777778in"
height="1.5972222222222223in"}

17

> **Problem 4 : Blue baby syndrome (infant methemoglobinemia) occurs
> when there is not enough exygen in the blood. The aim of the following
> network that leverages both clinical expertise and historic data. The
> below DAG represents the incidence and presentation of six possible
> diseases that would lead to a blue baby syndrome.**
>
> **(a)Construct the BN structure in R, what is the joint distribution
> written in compact factored form (modelstring use is acceptable)**
>
> Let us create the network as follows :

dag4 \<- **empty.graph**(nodes
=**c**(\"n1\",\"n2\",\"n3\",\"n4\",\"n5\",\"n6\",\"n7\",\"n8\",\"n9\",\"n10\",\"n11\",\"n12\",\"n13\",\"n14\"

> dag4 \<- **set.arc**(dag4, from = \"n1\", to = \"n2\")\
> dag4 \<- **set.arc**(dag4, from = \"n2\", to = \"n3\")\
> dag4 \<- **set.arc**(dag4, from = \"n2\", to = \"n4\")\
> dag4 \<- **set.arc**(dag4, from = \"n2\", to = \"n5\")\
> dag4 \<- **set.arc**(dag4, from = \"n2\", to = \"n6\")\
> dag4 \<- **set.arc**(dag4, from = \"n2\", to = \"n7\")\
> dag4 \<- **set.arc**(dag4, from = \"n2\", to = \"n8\")\
> dag4 \<- **set.arc**(dag4, from = \"n2\", to = \"n9\")\
> dag4 \<- **set.arc**(dag4, from = \"n4\", to = \"n15\")\
> dag4 \<- **set.arc**(dag4, from = \"n5\", to = \"n10\")\
> dag4 \<- **set.arc**(dag4, from = \"n6\", to = \"n10\")\
> dag4 \<- **set.arc**(dag4, from = \"n6\", to = \"n11\")\
> dag4 \<- **set.arc**(dag4, from = \"n7\", to = \"n11\")\
> dag4 \<- **set.arc**(dag4, from = \"n7\", to = \"n12\")\
> dag4 \<- **set.arc**(dag4, from = \"n7\", to = \"n13\")\
> dag4 \<- **set.arc**(dag4, from = \"n7\", to = \"n14\")\
> dag4 \<- **set.arc**(dag4, from = \"n8\", to = \"n13\")\
> dag4 \<- **set.arc**(dag4, from = \"n9\", to = \"n13\")\
> dag4 \<- **set.arc**(dag4, from = \"n9\", to = \"n14\")\
> dag4 \<- **set.arc**(dag4, from = \"n10\", to = \"n16\")\
> dag4 \<- **set.arc**(dag4, from = \"n11\", to = \"n16\")\
> dag4 \<- **set.arc**(dag4, from = \"n11\", to = \"n17\")\
> dag4 \<- **set.arc**(dag4, from = \"n12\", to = \"n18\")\
> dag4 \<- **set.arc**(dag4, from = \"n13\", to = \"n19\")\
> dag4 \<- **set.arc**(dag4, from = \"n14\", to = \"n20\")
>
> Let us see the description of network :

+-----------------------------------------------------------------------+
| > dag4                                                                |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Random/Generated Bayesian network
>
> \##
>
> \## model:\
> \##
> \[n1\]\[n2\|n1\]\[n3\|n2\]\[n4\|n2\]\[n5\|n2\]\[n6\|n2\]\[n7\|n2\]\[n8\|n2\]\[n9\|n2\]\[n10\|n5:n6\]
>
> \##
> \[n11\|n6:n7\]\[n12\|n7\]\[n13\|n7:n8:n9\]\[n14\|n7:n9\]\[n15\|n4\]\[n16\|n10:n11\]\[n17\|n11\]
>
> \## \[n18\|n12\]\[n19\|n13\]\[n20\|n14\]
>
> \## nodes: 20\
> \## arcs: 25
>
> \## undirected arcs: 0
>
> \## directed arcs: 25
>
> \## average markov blanket size: 3.10

18

![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image19.png){width="4.669444444444444in"
height="2.6630424321959754in"}![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image20.png){width="4.680555555555555in"
height="2.6805555555555554in"}

+-----------------------+-----------------------+-----------------------+
| \##                   | > average             | > 2.50                |
|                       | > neighbourhood size: |                       |
+=======================+=======================+=======================+
| \##                   | > average branching   | > 1.25                |
|                       | > factor:             |                       |
+-----------------------+-----------------------+-----------------------+

> \##

+-----------------------+-----------------------+-----------------------+
| \##                   | > generation          | > Empty               |
|                       | > algorithm:          |                       |
+=======================+=======================+=======================+
+-----------------------+-----------------------+-----------------------+

+--------+--------+--------+--------+--------+--------+--------+--------+
| > **   |        |        |        |        |        |        |        |
| plot** |        |        |        |        |        |        |        |
| (dag4) |        |        |        |        |        |        |        |
+========+========+========+========+========+========+========+========+
| n2     | n1     | n20    | n19    | n18    | > n17  | The    |        |
|        |        |        |        |        |        | joint  |        |
|        |        |        |        |        |        | distur |        |
|        |        |        |        |        |        | bution |        |
|        |        |        |        |        |        | of the |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| n3     |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| > n4   | n9     | n10    | n11    | n12    | n16    |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| > n5   |        |        |        |        | n15    |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| > n6   |        |        |        |        | n14    |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| n7     |        |        |        |        | > n13  |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| n8     |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| > n    |        |        |        |        |        |        |        |
| etwork |        |        |        |        |        |        |        |
| > is : |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| > **m  |        |        |        |        |        |        | \##    |
| odelst |        |        |        |        |        |        | \[1\]  |
| ring** |        |        |        |        |        |        |        |
| (dag4) |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+

> \"\[n1\]\[n2\|n1\]\[n3\|n2\]\[n4\|n2\]\[n5\|n2\]\[n6\|n2\]\[n7\|n2\]\[n8\|n2\]\[n9\|n2\]\[n10\|n5:n6\]\[n11\|n6:n7\]\[n12\|n7\]\[n13\|
>
> **(b)Draw the moral graph.**

+-----------------------------------------------------------------------+
| > moral_graph \<- **moral**(dag4)                                     |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > moral_graph                                                         |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Random/Generated Bayesian network
>
> \##

+-----------------------+-----------------------+-----------------------+
| \##                   | > model:              | > 20                  |
+=======================+=======================+=======================+
| \##                   | > \[undirected        |                       |
|                       | > graph\]             |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > nodes:              |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > arcs:               | > 31                  |
+-----------------------+-----------------------+-----------------------+
| \##                   | > undirected arcs:    | > 31                  |
+-----------------------+-----------------------+-----------------------+
| \##                   | > directed arcs:      | > 0                   |
+-----------------------+-----------------------+-----------------------+
| \##                   | > average markov      | > 3.10                |
|                       | > blanket size:       |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > average             | > 3.10                |
|                       | > neighbourhood size: |                       |
+-----------------------+-----------------------+-----------------------+
| \##                   | > average branching   | > 0.00                |
|                       | > factor:             |                       |
+-----------------------+-----------------------+-----------------------+

> \##

+-----------------------+-----------------------+-----------------------+
| \##                   | > generation          | > Empty               |
|                       | > algorithm:          |                       |
+=======================+=======================+=======================+
+-----------------------+-----------------------+-----------------------+

+-----------------------------------------------------------------------+
| > **plot**(moral_graph)                                               |
+=======================================================================+
+-----------------------------------------------------------------------+

19

![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image21.png){width="4.669444444444444in"
height="2.6630424321959754in"}![](vertopal_ff4eb2fa8e4b410dbcf755169d3228fe/media/image22.png){width="4.680555555555555in"
height="2.6666666666666665in"}

+--------+--------+--------+--------+--------+--------+--------+--------+
| n4     | > n3   | n2     | n1     | n20    | n19    | n18    | > n17  |
+========+========+========+========+========+========+========+========+
|        |        |        |        |        |        |        | > n16  |
+--------+--------+--------+--------+--------+--------+--------+--------+
| n5     | > n7   | n8     | n9     | n10    | n11    | n12    | n15    |
+--------+--------+--------+--------+--------+--------+--------+--------+
| n6     |        |        |        |        |        |        | > n14  |
+--------+--------+--------+--------+--------+--------+--------+--------+
|        |        |        |        |        |        |        | > n13  |
+--------+--------+--------+--------+--------+--------+--------+--------+

> **(c)Parametrize using the data posted with the assignment**

+-----------------------------------------------------------------------+
| > df4\<- **read.csv**(\"child_network.csv\")                          |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **head**(df4)                                                       |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## BirthAsphyxia HypDistrib HypoxiaInO2 CO2 ChestXray Grunting
> LVHreport
>
> \## 1 no Equal ModerateNormalOligaemic no no
>
> \## 2 no Equal SevereNormalAsy/Patch yes no
>
> \## 3 no Equal SevereNormal Normal no yes
>
> \## 4 no Equal ModerateNormalAsy/Patch yes no
>
> \## 5 no Equal ModerateNormal Normal no no
>
> \## 6 no Equal Moderate Normal Oligaemic no no
>
> \## LowerBodyO2 RUQO2 CO2Report XrayReport Disease GruntingReport Age
> LVH
>
> \## 1 5-12 5-12 \>=7.5Grd_Glass PAIVS no0-3_daysno
>
> \## 2 12+ \<5 \<7.5Asy/Patchy TGA no0-3_daysno
>
> \## 3 12+ 5-12 \<7.5 Normal TGA no0-3_daysyes
>
> \## 4 5-12 5-12 \>=7.5Asy/Patchy Lung yes0-3_daysno
>
> \## 5 5-12 5-12 \<7.5 NormalFallot no4-10_daysno
>
> \## 6 5-12 \<5 \<7.5OligaemicFallot yes4-10_daysno
>
> \## DuctFlowCardiacMixingLungParenchLungFlowSick
>
> \## 1 Lt_to_Rt Complete Normal Lowyes
>
> \## 2 None Transp. Abnormal Lowyes
>
> \## 3 None Transp. Normal Highyes
>
> \## 4 None Mild Abnormal Normalyes
>
> \## 5 Lt_to_Rt Complete Normal Low no
>
> \## 6 Lt_to_Rt Mild Normal Low no
>
> Convert the data into factors :

+-----------------------------------------------------------------------+
| > **for**(i **in colnames**(df4)){                                    |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > df4\[,i\] = **as.factor**(df4\[,i\])                                |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > }                                                                   |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **head**(df4)                                                       |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## BirthAsphyxia HypDistrib HypoxiaInO2 CO2 ChestXray Grunting
> LVHreport
>
> \## 1 no Equal Moderate Normal Oligaemic no no
>
> \## 2 no Equal Severe Normal Asy/Patch yes no
>
> \## 3 no Equal Severe Normal Normal no yes

20

> \## 4 no Equal Moderate Normal Asy/Patch yes no
>
> \## 5 no Equal Moderate Normal Normal no no
>
> \## 6 no Equal Moderate Normal Oligaemic no no
>
> \## LowerBodyO2 RUQO2 CO2Report XrayReport Disease GruntingReport Age
> LVH
>
> \## 1 5-12 5-12 \>=7.5Grd_Glass PAIVS no0-3_daysno
>
> \## 2 12+ \<5 \<7.5Asy/Patchy TGA no0-3_daysno
>
> \## 3 12+ 5-12 \<7.5 Normal TGA no0-3_daysyes
>
> \## 4 5-12 5-12 \>=7.5Asy/Patchy Lung yes0-3_daysno
>
> \## 5 5-12 5-12 \<7.5 NormalFallot no 4-10_days no
>
> \## 6 5-12 \<5 \<7.5OligaemicFallot yes 4-10_days no
>
> \## DuctFlow CardiacMixing LungParench LungFlow Sick
>
> \## 1 Lt_to_Rt Complete Normal Lowyes
>
> \## 2 None Transp. Abnormal Lowyes
>
> \## 3 None Transp. Normal Highyes
>
> \## 4 None Mild Abnormal Normalyes
>
> \## 5 Lt_to_Rt Complete Normal Low no
>
> \## 6 Lt_to_Rt Mild Normal Low no
>
> mapping \<- **c**(\"BirthAsphyxia\" = \"n1\",
>
> \"Disease\" = \"n2\",
>
> \"Age\" = \"n3\",
>
> \"LVH\" = \"n4\",
>
> \"DuctFlow\" = \"n5\",
>
> \"CardiacMixing\" = \"n6\",
>
> \"LungParench\" = \"n7\",
>
> \"LungFlow\" = \"n8\",
>
> \"Sick\" = \"n9\",
>
> \"HypDistrib\" = \"n10\",
>
> \"HypoxiaInO2\" = \"n11\",
>
> \"CO2\" = \"n12\",
>
> \"ChestXray\" = \"n13\",
>
> \"Grunting\" = \"n14\",
>
> \"LVHreport\" = \"n15\",
>
> \"LowerBodyO2\" = \"n16\",
>
> \"RUQO2\" = \"n17\",
>
> \"CO2Report\" = \"n18\",
>
> \"XrayReport\" = \"n19\",
>
> \"GruntingReport\" = \"n20\")
>
> **names**(df4) \<- **sapply**(**names**(df4), **function**(x)
> mapping\[\[x\]\])

+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| **h   |       | > n10 | n11   | > n12 | >     | > n18 | n19   | n2    |
| ead** |       |       |       |       | n13n1 |       |       |       |
| (df4) |       |       |       |       | 4n15n |       |       |       |
|       |       |       |       |       | 16n17 |       |       |       |
+=======+=======+=======+=======+=======+=======+=======+=======+=======+
| > \## | n1    |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+

> \## 1 no EqualModerateNormalOligaemicnono5-125-12\>=7.5Grd_GlassPAIVS
>
> \## 2 no Equal SevereNormalAsy/Patchyesno12+ \<5\<7.5Asy/Patchy TGA
>
> \## 3 no Equal SevereNormal Normalnoyes12+5-12\<7.5 Normal TGA
>
> \## 4 no EqualModerateNormalAsy/Patchyesno5-125-12\>=7.5Asy/Patchy
> Lung
>
> \## 5 no EqualModerateNormal Normalnono5-125-12\<7.5 NormalFallot
>
> \## 6 no EqualModerateNormalOligaemicnono5-12 \<5\<7.5OligaemicFallot
>
> \## n20 n3 n4 n5 n6 n7 n8n9
>
> \## 1 no0-3_days noLt_to_RtComplete Normal Lowyes
>
> \## 2 no0-3_days no NoneTransp.Abnormal Lowyes
>
> \## 3 no0-3_days yes NoneTransp. Normal Highyes
>
> \## 4 yes0-3_days no None MildAbnormalNormalyes
>
> \## 5 no4-10_days noLt_to_RtComplete Normal Lowno
>
> \## 6 yes4-10_days noLt_to_Rt Mild Normal Lowno

21

> Parametrize the network using the dataset :

+-----------------------------------------------------------------------+
| > bn_fit4 \<- **bn.fit**(dag4,data = df4,method = \"mle\")            |
+=======================================================================+
+-----------------------------------------------------------------------+

> **(d)What is the CPT for n13 ?**
>
> The cpt for n13 is :

+-----------------------------------------------------------------------+
| > bn_fit4**\$**n13                                                    |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Parameters of node n13 (multinomial distribution)
>
> \##
>
> \## Conditional probability table:
>
> \##
>
> \## , , n8 = High, n9 = no
>
> \##
>
> \## n7
>
> \## n13 Abnormal Congested Normal
>
> \## Asy/Patch 0.0489913540.1204819280.010821133
>
> \## Grd_Glass 0.3458213260.3493975900.031190325
>
> \## Normal 0.2449567720.0602409640.163590070
>
> \## Oligaemic 0.3342939480.0301204820.007001910
>
> \## Plethoric 0.0259365990.4397590360.787396563
>
> \##
>
> \## , , n8 = Low, n9 = no
>
> \##
>
> \## n7
>
> \## n13 Abnormal Congested Normal
>
> \## Asy/Patch 0.697594502 0.158163265 0.021129326
>
> \## Grd_Glass 0.051546392 0.500000000 0.021493625
>
> \## Normal 0.046391753 0.061224490 0.159562842
>
> \## Oligaemic 0.146048110 0.224489796 0.778870674
>
> \## Plethoric 0.058419244 0.056122449 0.018943534
>
> \##
>
> ##, , n8 = Normal, n9 = no
>
> \##
>
> \## n7
>
> \## n13 Abnormal Congested Normal
>
> \## Asy/Patch 0.8014981270.0916666670.031914894
>
> \## Grd_Glass 0.0449438200.6750000000.010638298
>
> \## Normal 0.0561797750.0583333330.903073286
>
> \## Oligaemic 0.0599250940.0250000000.021276596
>
> \## Plethoric 0.0374531840.1500000000.033096927
>
> \##
>
> \## , , n8 = High, n9 = yes
>
> \##
>
> \## n7
>
> \## n13 Abnormal Congested Normal
>
> \## Asy/Patch 0.0427350430.0903614460.008902077
>
> \## Grd_Glass 0.3632478630.4397590360.032640950
>
> \## Normal 0.2179487180.0602409640.169139466
>
> \## Oligaemic 0.3461538460.0240963860.010385757
>
> \## Plethoric 0.0299145300.3855421690.778931751
>
> \##

22

> \## , , n8 = Low, n9 = yes
>
> \##
>
> \## n7
>
> \## n13 Abnormal Congested Normal
>
> \## Asy/Patch 0.7469387760.1568627450.023133544
>
> \## Grd_Glass 0.0408163270.4901960780.017875920
>
> \## Normal 0.0612244900.0098039220.146161935
>
> \## Oligaemic 0.1061224490.2647058820.793901157
>
> \## Plethoric 0.0448979590.0784313730.018927445
>
> \##
>
> \## , , n8 = Normal, n9 = yes
>
> \##
>
> \## n7
>
> \## n13 Abnormal Congested Normal
>
> \## Asy/Patch 0.8071428570.0810810810.022222222
>
> \## Grd_Glass 0.0571428570.6283783780.013888889
>
> \## Normal 0.0464285710.0675675680.908333333
>
> \## Oligaemic 0.0500000000.0202702700.030555556
>
> \## Plethoric 0.0392857140.2027027030.025000000
>
> **(e)What is the CPT for n14 ?**
>
> The CPT for n14 is :

+-----------------------------------------------------------------------+
| > bn_fit4**\$**n14                                                    |
+=======================================================================+
+-----------------------------------------------------------------------+

> \##
>
> \## Parameters of node n14 (multinomial distribution)
>
> \##
>
> \## Conditional probability table:
>
> \##
>
> \## , , n9 = no
>
> \##
>
> \## n7
>
> \## n14 Abnormal Congested Normal
>
> \## no 0.38879599 0.78630705 0.94730725
>
> \## yes 0.61120401 0.21369295 0.05269275
>
> \##
>
> \## , , n9 = yes
>
> \##
>
> \## n7
>
> \## n14 Abnormal Congested Normal
>
> \## no 0.191040840.600961540.79949622
>
> \## yes 0.808959160.399038460.20050378
>
> **(f)Suppose "lower body O2 \>5" and "X-ray report = pleothoric", what
> can we deduce about**
>
> **the disease? Visualize this information on the network.**
>
> Based on the given info , The probability of having different diseases
> is as follows :

+-----------------------------------+-----------------------------------+
| > **for**(i **in c**(\"Fallot\" , | > **&** (n19 **==** \"P           |
| > \"Lung\" , \"PAIVS\" , \"PFC\"  |                                   |
| > , \"TAPVD\" , \"TGA\")){\       |                                   |
| > **print**( **cpquery**(bn_fit4  |                                   |
| > , event = (n2 **==** i) ,       |                                   |
| > evidence = (((n16 **==**        |                                   |
| > \"5-12\")**\|**(n16 **==**      |                                   |
| > \"12+\"))                       |                                   |
+===================================+===================================+
+-----------------------------------+-----------------------------------+

+-----------------------------------------------------------------------+
| > }                                                                   |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## \[1\] 0.1478261
>
> \## \[1\] 0.03198781

23

> \## \[1\] 0.1094605\
> \## \[1\] 0.02446982\
> \## \[1\] 0.08230769\
> \## \[1\] 0.6454678
>
> The child has a likelihood of 0.611 for TGA disease, which is high,
> and 0.021 for PFC disease, which is low.
>
> **(g)Suppose "lower body O2 \< 5" and "X-ray report = oligamic" but
> the child is "not grunting", what can we deduce about the disease?
> Visualize this information on the network.**

+-----------------------------------------------------------------------+
| > **for**(i **in c**(\"Fallot\" , \"Lung\" , \"PAIVS\" , \"PFC\" ,    |
| > \"TAPVD\" , \"TGA\")){                                              |
+=======================================================================+
+-----------------------------------------------------------------------+

> **print**( **cpquery**(bn_fit4 , event = (n2 **==** i) , evidence =
> ((n16 **==** \"\<5\") **&** (n19 **==** \"Oligaemic\") **&** (n14
> **=**

+-----------------------------------------------------------------------+
| > }                                                                   |
+=======================================================================+
+-----------------------------------------------------------------------+

\## \[1\] 0.452765\
\## \[1\] 0.002358491\
\## \[1\] 0.3416009\
\## \[1\] 0.05350773\
\## \[1\] 0.008373206\
\## \[1\] 0.09145608\
The child is more susceptible to PAVIS (0.34 probability) and Fallot
(0.434 probability).

> **(h)Baby Julie is "grunting" with "mild cardiac mixing". Baby George
> is "not grunting" with "complete cardiac mixing". Which is most at
> risk for the disease, and why?**
>
> For Baby Julie :

+-----------------------------------------------------------------------+
| > **for**(i **in c**(\"Fallot\" , \"Lung\" , \"PAIVS\" , \"PFC\" ,    |
| > \"TAPVD\" , \"TGA\")){                                              |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > **print**( **cpquery**(bn_fit4 , event = (n2 **==** i) , evidence = |
| > ((n6 **==** \"Mild\") **&** (n14 **==** \"yes\"))))                 |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
| > }                                                                   |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## \[1\] 0.1873536\
> \## \[1\] 0.4447236\
> \## \[1\] 0.01711491\
> \## \[1\] 0.1458886\
> \## \[1\] 0.01923077\
> \## \[1\] 0.1600985
>
> For Baby George :

+-----------------------------------------------------------------------+
| > **for**(i **in c**(\"Fallot\" , \"Lung\" , \"PAIVS\" , \"PFC\" ,    |
| > \"TAPVD\" , \"TGA\")){                                              |
+=======================================================================+
+-----------------------------------------------------------------------+

> **print**( **cpquery**(bn_fit4 , event = (n2 **==** i) , evidence =
> ((n6 **==** \"Complete\") **&** (n14 **==** \"no\"))))

+-----------------------------------------------------------------------+
| > }                                                                   |
+=======================================================================+
+-----------------------------------------------------------------------+

> \## \[1\] 0.4499405\
> \## \[1\] 0.001877494\
> \## \[1\] 0.4128761\
> \## \[1\] 0.0106615\
> \## \[1\] 0.06929316\
> \## \[1\] 0.0547682
>
> According to the aforementioned statistics, Baby George is at a higher
> risk of contracting the disease than Baby Julie because he has a 45.8
> percent chance of contracting Fallot and a 41.1 percent chance of
> being affected by PAVIS.

24
